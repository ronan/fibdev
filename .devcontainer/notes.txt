# echo "â¬†ï¸  Updating core and modules to lastest 9.x version ..."
# # git config --global --add safe.directory '*'
# composer10 update --no-install --with-all-dependencies --ignore-platform-req=php

# echo "ğŸ” Running upgrade status ..."
# composer10 require --no-audit --ignore-platform-req=php --dev drupal/upgrade_status 'drupal/composer_deploy:^1.7'
# drush10 pm:enable upgrade_status composer_deploy
# drush10 us-a --all  --ignore-custom --ignore-uninstalled > /workspace/outbox/upgrade-status.txt

# echo "ğŸªš  Rector? Damn near killed her!"
# echo "ğŸ§° Add developer modules ..."
# composer10 require --no-install --dev palantirnet/drupal-rector
# cp /workspace/drupal10/vendor/palantirnet/drupal-rector/rector.php /workspace/drupal10/vendor/
# /workspace/drupal10/vendor/bin/rector process /workspace/drupal10/web/modules/custom/savethebw
# sed '${s/$/|| \^10\.0/}' /workspace/drupal9/web/modules/custom/savethebw/savethebw.info.yml > /workspace/drupal10/web/modules/custom/savethebw/savethebw.info.yml

# cat /workspace/inbox/unupdatable-modules.txt | tr "\n" " " | xargs composer10 remove --no-update --no-audit

git clone https://git.drupalcode.org/issue/path_redirect_import-3373025.git

git clone https://git.drupalcode.org/issue/scheduled_updates-3172330.git scheduled_updates
cd scheduled_updates
git fetch "https://git.drupalcode.org/issue/scheduled_updates-3172330.git" '3172330-module-is-not'
git checkout -b 'scheduled_updates-3172330-3172330-module-is-not' FETCH_HEAD
git clone -b 3172330-module-is-not https://git.drupalcode.org/issue/scheduled_updates-3172330.git scheduled_updates

echo "ğŸ“Œ Unpin module versions ..."
cat /workspace/inbox/updatable-modules.txt | tr "\n" " " | xargs composer10 require --no-update --no-audit --ignore-platform-req=php

# composer10 show --direct -f json | jq -r '.installed[] | "\(.name):\(.version)"' > /workspace/outbox/installed-2.txt

cd /src/modules;
git clone "https://git.drupalcode.org/issue/video-3353255.git" -b 3353255-fix-undefined-error video


yarn add jquery-once


0) Pre-Prep 
    upgrade to latest 9x versions of everything
    push to prod?

1) Prep:
    set up before and after
    pull custom modules and run rector
    export list of modules (with upgrade problems)
    export upgrade_status

2) develop
    find replacement modules and patches
    fix and test custom composer_deploy
    update theme

3) Finalize
    Run the migration with the custom code and new versions/patches
    Compile to a single git repo
    git add commit

4) Push to prod



wget --spider -r -l 3 https://www.savetheboundarywaters.org 2>&1 \
            | grep '^--' \
            | awk '{ print $3 }' \
            | grep -vi '\.\(css\|js\|png\|gif\|jpg\|jpeg\|pdf\|mp4\|svg\)' \
            > urls.txt


drush10 uli admin/structure/paragraphs_type/homepage_banner_item/display